
DELETE [CopyActivityExecutionPlan]
   FROM [dbo].[CopyActivityExecutionPlan] p
  JOIN CopyActivitySink s
  on p.CopyActivitySinkKey = s.CopyActivitySinkKey
  JOIN CopyActivityExecutionGroup g on p.CopyActivityExecutionGroupKey = g.CopyActivityExecutionGroupKey
  where CopyActivityExecutionGroupName like
  'TSA Copy Process'

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Activities',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Activities WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Activities WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Activities',@CopyActivityDataADLSFileName = 'Activities.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_ActivitySubTypes',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.ActivitySubTypes WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.ActivitySubTypes WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/ActivitySubTypes',@CopyActivityDataADLSFileName = 'ActivitySubTypes.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_ActivityTypes',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.ActivityTypes WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.ActivityTypes WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/ActivityTypes',@CopyActivityDataADLSFileName = 'ActivityTypes.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Answers',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Answers WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Answers WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Answers',@CopyActivityDataADLSFileName = 'Answers.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_AnswersHistory',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.AnswersHistory WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.AnswersHistory WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/AnswersHistory',@CopyActivityDataADLSFileName = 'AnswersHistory.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Clients',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Clients WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Clients WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Clients',@CopyActivityDataADLSFileName = 'Clients.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA_Rolling Copy Process',@CopyActivityDataName='TSA_Engagements',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Engagements WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Engagements WITH (NOLOCK) WHERE Cast(LastUpdatedDate as Date)  >= Cast(DATEADD(DD,@IncrementalDays,GETDATE()) as Date)',@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Engagements',@CopyActivityDataADLSFileName = 'Engagements.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Files',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Files WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Files WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Files',@CopyActivityDataADLSFileName = 'Files.json';


DELETE [CopyActivityExecutionPlan]
   FROM [dbo].[CopyActivityExecutionPlan] p
  JOIN CopyActivitySink s
  on p.CopyActivitySinkKey = s.CopyActivitySinkKey
  JOIN CopyActivityExecutionGroup g on p.CopyActivityExecutionGroupKey = g.CopyActivityExecutionGroupKey
  where CopyActivityExecutionGroupName like
  'MAPS Copy Process'

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_Engagement',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Engagement WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Engagement WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/Engagement',@CopyActivityDataADLSFileName = 'Engagement.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_EngagementType',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.EngagementType WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.EngagementType WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/EngagementType',@CopyActivityDataADLSFileName = 'EngagementType.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_t_client_SIC',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.t_client_SIC WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.t_client_SIC WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/t_client_SIC',@CopyActivityDataADLSFileName = 't_client_SIC.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_Industry',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Industry WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Industry WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/Industry',@CopyActivityDataADLSFileName = 'Industry.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_SourceClient',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.SourceClient WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.SourceClient WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/SourceClient',@CopyActivityDataADLSFileName = 'SourceClient.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_SourceClientExtended',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.SourceClientExtended WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.SourceClientExtended WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/SourceClientExtended',@CopyActivityDataADLSFileName = 'SourceClientExtended.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_Contact',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Contact WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Contact WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/Contact',@CopyActivityDataADLSFileName = 'Contact.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_ClientService',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.ClientService WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.ClientService WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/ClientService',@CopyActivityDataADLSFileName = 'ClientService.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_LegalStatus',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.LegalStatus WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.LegalStatus WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/LegalStatus',@CopyActivityDataADLSFileName = 'LegalStatus.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'MAPS Copy Process',@CopyActivityDataName='MAPS_t_NAICS',@CopyActivityParameterValue='MAPSConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.t_NAICS WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.t_NAICS WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/MAPS/t_NAICS',@CopyActivityDataADLSFileName = 't_NAICS.json';
