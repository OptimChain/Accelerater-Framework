DECLARE @ContainerExecutionGroupName VARCHAR(255) = 'AX';
DECLARE @ContainerName varchar(255) = 'brtl';
DECLARE @DataFactoryName VARCHAR(255) = 'TBD';
DECLARE @NotebookName varchar(100) = 'AX_%'

--DELETE NotebookExecutionPlan
DELETE NotebookExecutionPlan
FROM NotebookExecutionPlan p
JOIN Notebook n ON p.NotebookKey = n.NotebookKey
JOIN Container c ON p.ContainerKey = c.ContainerKey
WHERE c.ContainerName = @ContainerName AND n.NotebookName like @NotebookName

--DELETE NotebookParameter
DELETE NotebookParameter
FROM NotebookParameter p
JOIN Notebook n ON p.NotebookKey = n.NotebookKey
WHERE NotebookName like @ContainerName+'%' AND n.NotebookName like @NotebookName

DECLARE @NotebookExecutionGroupName varchar(255) = @ContainerExecutionGroupName+' Convert'
-- Use Convert notebooks for .xlsx or .GZip files

SELECT @NotebookExecutionGroupName = @ContainerExecutionGroupName+' Ingest';
-- before running ingest it is necessary to run ADF pipeline that copies the extracted .txt files to .json in raw

EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTABLE_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTABLE',@ExternalDataPath='',@RawDataPath='/Raw/AX/INVENTJOURNALTABLE',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTRANS_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTRANS',@ExternalDataPath='',@RawDataPath='/Raw/AX/INVENTJOURNALTRANS',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='PARTITION,DATAAREAID,JOURNALID,LINENUM',@TimeStampColumns='MODIFIEDDATETIME';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferTable_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferTable',@ExternalDataPath='',@RawDataPath='/Raw/AX/InventTransferTable',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='PARTITION,DATAAREAID,TRANSFERID',@TimeStampColumns='CREATEDDATETIME';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferLine_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferLine',@ExternalDataPath='',@RawDataPath='/Raw/AX/InventTransferLine',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='LINENUM,TRANSFERID,DATAAREAID,PARTITION',@TimeStampColumns='CREATEDDATETIME';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_BTLTransferReleaseHistoryLog_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='BTLTransferReleaseHistoryLog',@ExternalDataPath='',@RawDataPath='/Raw/AX/BTLTransferReleaseHistoryLog',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_PurchTable_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='PurchTable',@ExternalDataPath='',@RawDataPath='/Raw/AX/PurchTable',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='PARTITION,DATAAREAID,PURCHID',@TimeStampColumns='CREATEDDATETIME';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_Purchline_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='Purchline',@ExternalDataPath='',@RawDataPath='/Raw/AX/Purchline',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='PARTITION,DATAAREAID,INVENTTRANSID',@TimeStampColumns='MODIFIEDDATETIME';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANS_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANS',@ExternalDataPath='',@RawDataPath='/Raw/AX/INVENTTRANS',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='RECID',@TimeStampColumns='DATESTATUS';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANSPOSTING_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANSPOSTING',@ExternalDataPath='',@RawDataPath='/Raw/AX/INVENTTRANSPOSTING',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='TRANSDATE,VOUCHER,INVENTTRANSPOSTINGTYPE,INVENTTRANSORIGIN,DATAAREAID,PARTITION',@TimeStampColumns='TRANSDATE';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_REQTRANS_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='REQTRANS',@ExternalDataPath='',@RawDataPath='/Raw/AX/REQTRANS',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='RECID',@TimeStampColumns='REQDATE';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_RETAILCHANNELTABLE_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='RETAILCHANNELTABLE',@ExternalDataPath='',@RawDataPath='/Raw/AX/RETAILCHANNELTABLE',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTABLE_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTABLE',@ExternalDataPath='',@RawDataPath='/Raw/AX/INVENTTABLE',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_Sales_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='Sales',@ExternalDataPath='',@RawDataPath='/Raw/InventoryBudget/Sales',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_Margin_Ingest',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='Margin',@ExternalDataPath='',@RawDataPath='/Raw/InventoryBudget/Margin',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite Delta Lake',@PrimaryKeyColumns='',@TimeStampColumns='';

SELECT @NotebookExecutionGroupName = @ContainerExecutionGroupName+' Enrich';

--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTABLE_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTABLE',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTRANS_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTRANS',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferTable_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferTable',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferLine_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferLine',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_BTLTransferReleaseHistoryLog_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='BTLTransferReleaseHistoryLog',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_PurchTable_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='PurchTable',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_Purchline_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='Purchline',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANS_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANS',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANSPOSTING_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANSPOSTING',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_REQTRANS_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='REQTRANS',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_RETAILCHANNELTABLE_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='RETAILCHANNELTABLE',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTABLE_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTABLE',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Enrich',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';

EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_FCTPurchLine_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=32,@QueryZoneSchemaName='brtl',@QueryZoneTableName='FCTPurchLine',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Append FCTPurchLine',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_DIMProduct_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='DIMProduct',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite DIMProduct',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_DIMVendor_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='DIMVendor',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite DIMVendor',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_FCTInventoryBudgetSales_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='FCTInventoryBudgetSales',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite FCTInventoryBudgetSales',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_FCTInventoryBudgetMargin_Enrich',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=8,@QueryZoneSchemaName='brtl',@QueryZoneTableName='FCTInventoryBudgetMargin',@ExternalDataPath='',@QueryZoneNotebookPath='/Framework/Query Zone Processing - Overwrite FCTInventoryBudgetMargin',@PrimaryKeyColumns='',@TimeStampColumns='',@RawDataPath='';

SELECT  @NotebookExecutionGroupName = @ContainerExecutionGroupName+' Sanction';

--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTABLE_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTABLE',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTJOURNALTRANS_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTJOURNALTRANS',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferTable_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferTable',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_InventTransferLine_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='InventTransferLine',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_BTLTransferReleaseHistoryLog_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='BTLTransferReleaseHistoryLog',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='/0',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_PurchTable_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='PurchTable',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_Purchline_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='Purchline',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANS_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANS',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTRANSPOSTING_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='INVENTTRANSPOSTING',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_REQTRANS_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='REQTRANS',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_RETAILCHANNELTABLE_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='brtl',@QueryZoneTableName='RETAILCHANNELTABLE',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
--EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_INVENTTABLE_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='',@QueryZoneTableName='INVENTTABLE',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='0',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_DIMProduct_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='',@QueryZoneTableName='DIMProduct',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_DIMVendor_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='',@QueryZoneTableName='DIMVendor',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_FCTInventoryBudgetSales_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='',@QueryZoneTableName='FCTInventoryBudgetSales',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='0',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
EXEC dbo.uspInsertNotebookParameters @NotebookName = 'AX_FCTInventoryBudgetMargin_Sanction',@NotebookExecutionGroupName=@NotebookExecutionGroupName,@DataFactoryName=@DataFactoryName,@ContainerName=@ContainerName,@ContainerExecutionGroupName=@ContainerExecutionGroupName,@NotebookOrder=10,@NumPartitions=2,@QueryZoneSchemaName='',@QueryZoneTableName='FCTInventoryBudgetMargin',@ExternalDataPath='',@RawDataPath='',@QueryZoneNotebookPath='',@SummaryZoneNotebookPath='0',@SanctionedZoneNotebookPath='/Framework/Sanctioned Zone Processing - Load Synapse DW',@VacuumRetentionHours=168,@SummaryZoneRemoveHDFSOutputCommitterFiles = '1', @SummaryZoneRenameSummaryOutputFile = '1';
