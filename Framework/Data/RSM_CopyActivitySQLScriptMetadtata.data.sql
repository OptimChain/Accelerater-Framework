EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Activities',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Activities WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Activities WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Activities',@CopyActivityDataADLSFileName = 'Activities.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_ActivitySubTypes',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.ActivitySubTypes WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.ActivitySubTypes WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/ActivitySubTypes',@CopyActivityDataADLSFileName = 'ActivitySubTypes.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_ActivityTypes',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.ActivityTypes WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.ActivityTypes WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/ActivityTypes',@CopyActivityDataADLSFileName = 'ActivityTypes.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Answers',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Answers WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Answers WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Answers',@CopyActivityDataADLSFileName = 'Answers.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_AnswersHistory',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.AnswersHistory WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.AnswersHistory WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/AnswersHistory',@CopyActivityDataADLSFileName = 'AnswersHistory.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Clients',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Clients WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Clients WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Clients',@CopyActivityDataADLSFileName = 'Clients.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA_Rolling Copy Process',@CopyActivityDataName='TSA_Engagements',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Engagements WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Engagements WITH (NOLOCK) WHERE Cast(LastUpdatedDate as Date)  >= Cast(DATEADD(DD,@IncrementalDays,GETDATE()) as Date)',@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Engagements',@CopyActivityDataADLSFileName = 'Engagements.json';
EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'rsm',@CopyActivityExecutionGroupName = 'TSA Copy Process',@CopyActivityDataName='TSA_Files',@CopyActivityParameterValue='TSAConnectionString',@CopyActivityDataSQLScript='SELECT * FROM dbo.Files WITH (NOLOCK)',@CopyActivityDataIncrementalSQLScript='SELECT * FROM dbo.Files WITH (NOLOCK)',@IsIncremental=0,@CopyActivityDataADLSFolderPath = '/Raw/TSA/Files',@CopyActivityDataADLSFileName = 'Files.json';
