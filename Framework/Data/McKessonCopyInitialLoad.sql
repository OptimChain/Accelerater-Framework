EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'brtl',@CopyActivityExecutionGroupName = 'McKesson Copy Process',@CopyActivityDataName='McKesson_FILL_FACT1',@CopyActivityParameterValue='AXConnectionString'
,@CopyActivityDataSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT'
,@CopyActivityDataIncrementalSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT WHERE FILL_FACT_KEY >=  (SELECT MAX(FILL_FACT_KEY) -1000000 FROM TREXONE_DW_DATA.FILL_FACT) AND FILL_FACT_KEY <=  (SELECT MAX(FILL_FACT_KEY) -500000 FROM TREXONE_DW_DATA.FILL_FACT)'
,@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/McKesson/FILL_FACT',@CopyActivityDataADLSFileName = 'FILL_FACT.json';

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'brtl',@CopyActivityExecutionGroupName = 'McKesson Copy Process',@CopyActivityDataName='McKesson_FILL_FACT2',@CopyActivityParameterValue='AXConnectionString'
,@CopyActivityDataSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT'
,@CopyActivityDataIncrementalSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT WHERE FILL_FACT_KEY >=  (SELECT MAX(FILL_FACT_KEY) -1500000 FROM TREXONE_DW_DATA.FILL_FACT) AND FILL_FACT_KEY <=  (SELECT MAX(FILL_FACT_KEY) -1000000 FROM TREXONE_DW_DATA.FILL_FACT)'
,@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/McKesson/FILL_FACT',@CopyActivityDataADLSFileName = 'FILL_FACT.json';

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'brtl',@CopyActivityExecutionGroupName = 'McKesson Copy Process',@CopyActivityDataName='McKesson_FILL_FACT3',@CopyActivityParameterValue='AXConnectionString'
,@CopyActivityDataSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT'
,@CopyActivityDataIncrementalSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT WHERE FILL_FACT_KEY >=  (SELECT MAX(FILL_FACT_KEY) -2000000 FROM TREXONE_DW_DATA.FILL_FACT) AND FILL_FACT_KEY <=  (SELECT MAX(FILL_FACT_KEY) -1500000 FROM TREXONE_DW_DATA.FILL_FACT)'
,@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/McKesson/FILL_FACT',@CopyActivityDataADLSFileName = 'FILL_FACT.json';

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'brtl',@CopyActivityExecutionGroupName = 'McKesson Copy Process',@CopyActivityDataName='McKesson_FILL_FACT4',@CopyActivityParameterValue='AXConnectionString'
,@CopyActivityDataSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT'
,@CopyActivityDataIncrementalSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT WHERE FILL_FACT_KEY >=  (SELECT MAX(FILL_FACT_KEY) -2500000 FROM TREXONE_DW_DATA.FILL_FACT) AND FILL_FACT_KEY <=  (SELECT MAX(FILL_FACT_KEY) -2000000 FROM TREXONE_DW_DATA.FILL_FACT)'
,@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/McKesson/FILL_FACT',@CopyActivityDataADLSFileName = 'FILL_FACT.json';

EXECUTE [dbo].[uspInsertSQLScriptCopyMetadata] @ContainerName = 'brtl',@CopyActivityExecutionGroupName = 'McKesson Copy Process',@CopyActivityDataName='McKesson_FILL_FACT5',@CopyActivityParameterValue='AXConnectionString'
,@CopyActivityDataSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT'
,@CopyActivityDataIncrementalSQLScript='SELECT FILL_FACT_KEY,ORDER_DATE_KEY,ORDER_TIME_KEY,PRESCRIBED_DATE_KEY,READY_DATE_KEY,READY_TIME_KEY,PROMISE_DATE_KEY,PROMISE_TIME_KEY,EXPIRY_DATE_KEY,PRS_PRESCRIBER_KEY,PRSH_PRESCRIBER_KEY,PADR_KEY,FD_FACILITY_KEY,PRD_PRODUCT_KEY,OS_ORDER_SOURCE_KEY,LF_LATIN_FREQUENCY_KEY,GS_GENERIC_SUB_KEY,TSC_THERAPUETIC_SUB_CODE_KEY,DC_DAW_CODE_KEY,FILL_INDICATOR_KEY,DM_DELIVERY_METHOD_KEY,RX_RECORD_NUM,RX_FILL_SEQ,FACILITY_ORDER_NUMBER,REFILL_NUM,FIRST_FILL_QTY,NEXT_FILL_QTY,REFILL_QTY,QTY_DISPENSED,METRIC_QTY_DISPENSED,INTENDED_QTY_DISPENSED,INTENDED_DAYS_SUPPLY,DAYS_SUPPLY,ORDER_QUOTE_PRICE,TP_PRICE_PAID,PATIENT_PRICE_PAID,TOTAL_PRICE_PAID,DISPENSED_QTY_AWP,FILL_DURATION_SECS,PARTITION_DATE,FS_FILL_STATUS_KEY,DISPENSED_PRD_PRODUCT_KEY,TRANSACTION_DATE,CANCEL_DATE_KEY,CANCEL_TIME_KEY,CENTRAL_FILL_FD_FACILITY_KEY,CF_LOCAL_PRD_PRODUCT_KEY,USER_DEFINED_STEP_AMT,PATIENT_TAX_AMT,TP_TAX_AMT,TRIPLICATE_SERIAL_NUM,TOTAL_UNC,FULL_PACKAGE_UNC,NON_DISCOUNTED_UNC,TRANSACTION_CODE,WRITTEN_DATE_KEY,WRITTEN_TIME_KEY,FIRST_FILL_DATE_KEY,FIRST_FILL_TIME_KEY,WRITTEN_QTY,TOTAL_REFILLS_ALLOWED,TOTAL_REFILLS_REMAINING,SOLD_DATE_KEY,SOLD_TIME_KEY,DISPENSED_DATE_KEY,DISPENSED_TIME_KEY,ADJUDICATION_GROUP_NUM,WRITTEN_DRUG_KEY,DISPENSED_DRUG_KEY,LAST_FILL_DATE_KEY,LAST_FILL_TIME_KEY,IS_COB,COST_PRICING_FORMULA_NAME,IS_BAR,OVERRIDE_AMOUNT,OVERRIDE_CODE_KEY,ERP_ENROLLMENT_CODE_NUM,ERP_ENROLLMENT_STATUS_DATE,ERP_ENROLLMENT_REASON_CODE_NUM,ERP_TARGET_DATE,ERP_EXCLUSION_REASON_CODE_NUM,CRF_SEQ_NUM,IS_340B,COUNSELING_ACCEPTED,COUNSELING_COMMENTS,UNSOLD_DATE_KEY,COUNSELING_SIGN_IMAGE_KEY,IS_RETURNED_TO_STOCK,RET_TO_STCK_QTY,RET_TO_STCK_DT_KEY,SIG,ADJUDICATION_DATE_KEY,ADJ_DATE_OF_SERVICE_KEY,BILLED_AMOUNT,RTP_DATE_KEY,RTP_TIME_KEY,TPD_KEY,IS_ERP_OPPORTUNITY,PATIENT_ERP_ENROLLMENT_STATUS,ORDER_NUM,SHIPMENT_NUM,MCKESSON_GENERIC_OPPORTUNITY,MCKESSON_GENERIC_STATUS,DISPENSING_FEE_AMOUNT,INGREDIENT_COST,MCKESSON_GENERIC_AVAIL,IS_SERVICE,IS_AUTO_DISPENSED,LTC_FACILITY_KEY,LTC_PACKAGING_METHOD_KEY,LTC_RX_START_DATE_KEY,LTC_RX_DUE_DATE_KEY,LTC_RX_STOP_DATE_KEY,LTC_RX_CYCLE_FILL_IND,LTC_BILLING_TYPE,LTC_MAINTENANCE_DRUG,LTC_DELIVERY_DATE_KEY,LTC_FACILITY_NODE_KEY,RX_EXPIRY_DATE_KEY,RX_EXPIRY_TIME_KEY,DATA_ENTRY_USER_KEY,DISPENSING_USER_KEY,LTC_HOA_KEY,LOCAL_TRANSACTION_DATE,FUTURE_FILL_DATE_KEY,IS_PRN,PRIORITY,IS_MAIL,IS_EDIT_TP,RX_ORIGIN_CODE,PARTIAL_FILL_SEQ,IS_PARTIAL_FILL_BILLED,PRDC_CHAR_KEY,IS_BAR_SOURCE,IS_EDIT_TP_SOURCE,IS_PARTIAL_AUTOBILLED,IS_PARTIAL_AUTOBILLED_SOURCE,IS_SPLIT_ORDER,SPLIT_ORDER_USER_KEY,SPLIT_ORDER_DATE,SYNC_DATE_KEY,OS_ITEM_SOURCE_KEY,IS_SAME_DAY_REVERSAL,LATIN_FREQUENCY_QTY,INCENTIVE_FEE_AMOUNT,TOTAL_TAX,BIN_NAME,SKIP_PRE_VER_CODE,FOA_DATE,ACUTE_PROMISE_REASON_CODE,H_LEVEL,REQUIRE_CONSENT_TO_FILL,DATE_CONSENTED_TO_FILL,IS_CONSENTED_TO_FILL
FROM TREXONE_DW_DATA.FILL_FACT WHERE FILL_FACT_KEY >=  (SELECT MAX(FILL_FACT_KEY) -3000000 FROM TREXONE_DW_DATA.FILL_FACT) AND FILL_FACT_KEY <=  (SELECT MAX(FILL_FACT_KEY) -2500000 FROM TREXONE_DW_DATA.FILL_FACT)'
,@IsIncremental=1,@CopyActivityDataADLSFolderPath = '/Raw/McKesson/FILL_FACT',@CopyActivityDataADLSFileName = 'FILL_FACT.json';
